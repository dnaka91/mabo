---
source: crates/mabo-kotlin/tests/render.rs
description: "struct Sample<T>{a:u32@1,b:bool@2,c:T@3}"
input_file: crates/mabo-parser/tests/inputs/struct_min_ws.mabo
---
--- sample.kt

package sample

import java.math.BigInteger
import java.nio.ByteBuffer
import kotlin.UByte
import kotlin.UShort
import kotlin.UInt
import kotlin.ULong

import rocks.dnaka91.mabo.*
import rocks.dnaka91.mabo.buf.*

public data class Sample<T>(
    val a: UInt,
    val b: Boolean,
    val c: T,
) : Encode, Size {
    override fun encode(w: ByteBuffer) {
        Encoder.encodeField(w, 1) { w -> Encoder.encodeU32(w, this.a) }
        Encoder.encodeField(w, 2) { w -> Encoder.encodeBool(w, this.b) }
        Encoder.encodeField(w, 3) { w -> this.c.encode(w) }
        Encoder.encodeU32(w, END_MARKER)
    }

    override fun size(): Int = 0 +
        Sizer.sizeField(1) { Sizer.sizeU32(this.A) } +
        Sizer.sizeField(2) { Sizer.sizeBool(this.B) } +
        Sizer.sizeField(3) { this.C.size() } +
        Sizer.sizeFieldId(END_MARKER)

    companion object : Decode<Sample<T>> {
        override fun decode(r ByteBuffer): Result<Sample<T>> = runCatching {
            var a: UInt? = null
            var b: Boolean? = null
            var c: T? = null

            while (true) {
                val id = Decoder.decodeFieldId(r).getOrThrow()
                when (id.value) {
                    1u -> a = Decoder.decodeU32(r).getOrThrow()
                    2u -> b = Decoder.decodeBool(r).getOrThrow()
                    3u -> c = T.decode(r).getOrThrow()
                    END_MARKER -> break
                }
            }

            Sample(
                a ?: throw MissingFieldException(1u, "a"),
                b ?: throw MissingFieldException(2u, "b"),
                c ?: throw MissingFieldException(3u, "c"),
            )
        }
    }
}


